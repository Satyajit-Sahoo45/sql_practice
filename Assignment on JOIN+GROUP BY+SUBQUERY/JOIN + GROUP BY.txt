TOPIC: JOIN + GROUP BY (INTERMEDIATE LEVEL)
-------------------------------------------

A1.	SELECT D.DEPTNO, SUM(E.SAL)
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY D.DEPTNO;

A2.	SELECT D.DNAME, COUNT(E.EMPNO)
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY D.DNAME;

A3.	SELECT D.DNAME, AVG(E.SAL) AS DEPT_AVG_SAL
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY D.DNAME
	HAVING AVG(E.SAL) > 5000;

A4.	SELECT D.DNAME, SUM(E.SAL) AS DEPT_TOTAL_SAL
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY D.DNAME
	HAVING SUM(E.SAL) > 30000;

A5.	SELECT M.ENAME AS MANAGER_NAME, SUM(E.SAL) AS TOTAL_SAL
	FROM EMP E
	JOIN EMP M
	ON E.MGR=M.EMPNO
	GROUP BY M.ENAME;

A6.	SELECT E.JOB, AVG(E.SAL) AS AVG_SAL
	FROM EMP E
	GROUP BY E.JOB;

A7.	SELECT MAX(E.SAL), D.DNAME
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY D.DNAME;

A8.	SELECT E.ENAME, EE.ENAME AS MANAGER_NAME, D.DNAME AS EMP_DEPT_NAME
	FROM EMP E
	JOIN EMP EE
	ON E.MGR=EE.EMPNO
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO;

A9.	SELECT D.LOC AS LOCATION, COUNT(E.EMPNO) AS NO_EMP
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY D.LOC;

A10.	SELECT D.DNAME, COUNT(E.EMPNO)
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY D.DNAME
	HAVING COUNT(E.EMPNO)>5;

A11.	SELECT E.JOB, SUM(E.SAL), D.DNAME
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO = D.DEPTNO
	GROUP BY E.JOB, D.DNAME;

A12.	SELECT E.*
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO = D.DEPTNO
	WHERE D.LOC='NEW YORK';

A13.	SELECT E.ENAME, D.DNAME
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO = D.DEPTNO;

A14.	SELECT AVG(E.SAL) AS AVERAGE_SAL, D.DNAME
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO = D.DEPTNO
	GROUP BY D.DNAME;

A15.	SELECT D.DNAME, COUNT(E.EMPNO)
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO = D.DEPTNO
	WHERE E.SAL>2000
	GROUP BY D.DNAME;

A16.	SELECT D.DNAME, AVG(E.COMM)
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	WHERE D.DNAME='SALES'
	GROUP BY D.DNAME;

A17.	SELECT D.DNAME AS DEPT_NAME, M.ENAME AS DEPT_MGR_NAME
	FROM EMP M
	JOIN DEPT D
	ON M.DEPTNO = D.DEPTNO
	WHERE M.JOB='MANAGER';

A18.	SELECT M.ENAME AS MGR_NAME, COUNT(E.EMPNO) AS EMP_COUNT
	FROM EMP E
	JOIN EMP M
	ON E.MGR=M.EMPNO
	GROUP BY M.ENAME
	HAVING COUNT(E.EMPNO) > 3;

A19.	SELECT D.DNAME, E.ENAME
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO = D.DEPTNO
	WHERE E.COMM IS NULL OR E.COMM = 0;

A20.	SELECT D.DNAME, D.LOC, SUM(E.SAL)
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY D.DNAME, D.LOC;

===========================================================================
TOPIC: JOIN + GROUP BY (ADVANCED LEVEL)
---------------------------------------

A1.	SELECT D.DNAME, AVG(E.SAL)
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY D.DNAME
	HAVING AVG(E.SAL) > (SELECT AVG(SAL) FROM EMP);

A2.	SELECT E.DEPTNO, D.DNAME, E.SAL
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	WHERE E.SAL > 3000;

A3.	SELECT E.DEPTNO, D.DNAME, SUM(E.SAL) AS TOTAL_SALARY
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY E.DEPTNO, D.DNAME;

A4.	SELECT D.DNAME
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	WHERE E.JOB IN ('CLERK', 'MANAGER')
	GROUP BY D.DNAME;

A5.	SELECT D.DNAME
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO=D.DEPTNO
	GROUP BY D.DNAME
	HAVING MAX(E.SAL)-MIN(E.SAL) > 5000;

A6.	SELECT E.ENAME, E.SAL, E.DEPTNO
	FROM EMP E
	WHERE E.SAL > ANY(SELECT AVG(SAL) FROM EMP
			GROUP BY DEPTNO);
	
A7.	SELECT E.DEPTNO, SUM(E.COMM)
	FROM EMP E
	JOIN DEPT D
	ON E.DEPTNO = D.DEPTNO
	GROUP BY E.DEPTNO;

A8.	SELECT DEPTNO, COUNT(*)
	FROM EMP
	WHERE HIREDATE > '01-JAN-1981'
	GROUP BY DEPTNO
	HAVING COUNT(*) >= 1;

A9.	SELECT M.EMPNO AS MANAGER_ID, M.ENAME AS MANAGER_NAME, SUM(E.SAL) AS TOTAL_TEAM_SAL, AVG(E.SAL) AS TEAM_AVG_SAL
	FROM EMP E
	JOIN EMP M
	ON E.MGR=M.EMPNO
	GROUP BY M.EMPNO, M.ENAME;

A10.	SELECT D.DEPTNO, D.DNAME
	FROM DEPT D
	WHERE D.DEPTNO IN (SELECT DEPTNO
   	        	   FROM EMP
			   GROUP BY DEPTNO
			   HAVING MAX(SAL) > (SELECT AVG(SAL) FROM EMP));
	


