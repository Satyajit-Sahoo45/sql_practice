TOPIC - SUBQUERY (INTERMEDIATE LEVEL)

A-1 :	SELECT * FROM EMP
	WHERE SAL > (SELECT AVG(SAL) FROM EMP);

A-2 : 	SELECT * FROM EMP E
	WHERE SAL > (SELECT AVG(SAL) FROM EMP
		     WHERE E.DEPTNO=DEPTNO);

A-3 : 	SELECT DEPTNO FROM EMP
	GROUP BY DEPTNO
	HAVING COUNT(*) > 5;

A-4 :	SELECT * FROM EMP
	WHERE COMM IS NULL OR COMM = 0;

A-5 :	SELECT ENAME, DEPTNO FROM EMP
	WHERE DEPTNO = (SELECT DEPTNO FROM 
				(SELECT DEPTNO FROM EMP
				 GROUP BY DEPTNO
				 ORDER BY AVG(SAL) DESC
				)
			WHERE ROWNUM=1
	);

A-6 :	SELECT E.ENAME, E.SAL, E.DEPTNO FROM EMP E
	WHERE SAL < (SELECT MAX(SAL) FROM EMP
		     WHERE DEPTNO = E.DEPTNO);

A-7 : 	SELECT EMPNO, ENAME FROM EMP
	WHERE JOB='MANAGER' AND SAL > (SELECT AVG(SAL) FROM EMP);

A-8 :	SELECT ENAME, JOB FROM EMP
	WHERE JOB = (SELECT JOB FROM EMP
		     WHERE ENAME='SMITH');

A-9 :	SELECT ENAME, SAL FROM EMP
	WHERE SAL > (SELECT SAL FROM EMP
		     WHERE EMPNO=7369);

A-10 :	SELECT ENAME, HIREDATE FROM EMP
	WHERE HIREDATE IN (SELECT HIREDATE FROM EMP
			   GROUP BY HIREDATE
			   HAVING MIN(SAL) < 2000);

A-11 :	SELECT * FROM EMP
 	WHERE SAL IN ();

A-12:	SELECT * FROM EMP
	WHERE SAL > ALL(SELECT SAL FROM EMP WHERE DEPTNO=20);

A-13: 	SELECT * FROM EMP E
	WHERE SAL BETWEEN (SELECT MIN(SAL) FROM EMP WHERE DEPTNO=E.DEPTNO)
	AND (SELECT MAX(SAL) FROM EMP WHERE DEPTNO=E.DEPTNO);

A-14:	SELECT MAX(SAL) FROM EMP
	WHERE SAL < (SELECT MAX(SAL) FROM EMP);

A-15:	SELECT ENAME, SAL FROM EMP
	WHERE SAL = (SELECT SAL FROM EMP
		     WHERE ENAME = 'JONES');

A-16:	SELECT ENAME, SAL, COMM FROM EMP
	WHERE COMM > (SELECT AVG(COMM) FROM EMP WHERE COMM IS NOT NULL);

A-17:	SELECT * FROM EMP
	WHERE DEPTNO != (SELECT DEPTNO FROM EMP
			 WHERE ENAME='FORD');

A-18:	SELECT E.* FROM EMP E
	WHERE SAL != (SELECT AVG(SAL) FROM EMP WHERE DEPTNO=E.DEPTNO);

A-19:	SELECT ENAME, DEPTNO
	FROM EMP
	WHERE DEPTNO IN (SELECT DEPTNO FROM EMP
			 GROUP BY DEPTNO
			 HAVING COUNT(*) = 1);

A-20: 	SELECT * FROM EMP
	WHERE SAL > ALL(SELECT SAL FROM EMP
			WHERE DEPTNO=30);


--------------------(SUBQUERY ADVANCED LEVEL)-----------------

A-1:	SELECT * FROM EMP
	WHERE SAL > (SELECT AVG(SAL) 
		     FROM (SELECT SAL 
			   FROM (SELECT SAL FROM EMP
				 ORDER BY SAL DESC)
		    	   WHERE ROWNUM <= 3
		     )
	);

A-2:	SELECT E.ENAME, E.JOB, E.SAL FROM EMP E
	WHERE SAL > (SELECT AVG(SAL) FROM EMP
		     WHERE E.JOB=JOB);

A-3:	SELECT DNAME FROM DEPT
	WHERE DEPTNO = (SELECT DEPTNO FROM EMP
			WHERE SAL < 3000);

A-4: 	SELECT E.EMPNO, E.ENAME, E.SAL, E.DEPTNO FROM EMP E
	WHERE E.SAL < (SELECT MAX(SAL) FROM EMP
		     WHERE E.DEPTNO = DEPTNO);

A-5:	SELECT E.ENAME, E.SAL FROM EMP E
	WHERE E.SAL > (SELECT SUM(MIN(SAL)) FROM EMP
		     GROUP BY DEPTNO);

A-6:	SELECT E.* FROM EMP E
	WHERE E.SAL > (SELECT AVG(SAL) FROM EMP
		     WHERE DEPTNO IN (10, 20));

A-7:	SELECT * FROM EMP
	WHERE SAL BETWEEN (SELECT MAX(SAL) FROM EMP
			   WHERE SAL < (SELECT MAX(SAL) FROM EMP
					)) 
		  AND	
			(SELECT MAX(SAL) FROM EMP
			 WHERE SAL < (SELECT MAX(SAL) FROM EMP
				      WHERE SAL < (SELECT MAX(SAL) FROM EMP);


A-8:	SELECT * FROM EMP
	WHERE SAL > (SELECT MEDIAN(SAL) FROM EMP);

A-9:	SELECT * FROM EMP
	WHERE 

A-10:	SELECT E.* FROM EMP E
	WHERE E.SAL > (SELECT AVG(SAL) FROM EMP
		       where E.DEPTNO = DEPTNO AND E.EMPNO <> EMPNO);

A-11:	SELECT * FROM EMP
	WHERE SAL > ANY(SELECT SAL FROM EMP
			WHERE DEPTNO = 30);

A-12:	SELECT 

A-13:	SELECT * FROM EMP
	WHERE SAL > (SELECT AVG(SAL) FROM EMP
		     WHERE JOB='MANAGER');

A-14:	SELECT E.* FROM EMP E
	WHERE E.SAL > (SELECT AVG(SAL) FROM EMP
		     WHERE TO_CHAR(E.HIREDATE, 'YYYY') = TO_CHAR(HIREDATE, 'YYYY'));

A-15: 	SELECT 

A-16:	SELECT E.* FROM EMP E
	WHERE SAL < (SELECT AVG(SAL) FROM EMP
		     WHERE E.JOB=JOB);

A-17: 	SELECT E.* FROM EMP E
	WHERE SAL BETWEEN (SELECT AVG(SAL) FROM EMP
			    WHERE DEPTNO=20)
		   AND
			(SELECT AVG(SAL) FROM EMP
			 WHERE DEPTNO=10);

A-18:	SELECT E.* FROM EMP E
	WHERE E.DEPTNO IN (SELECT DEPTNO FROM EMP
		           GROUP BY DEPTNO
			   HAVING COUNT(*) > 5)
	AND E.SAL > (SELECT AVG(SAL) FROM EMP
		     WHERE E.DEPTNO = DEPTNO);

A-19:	SELECT E.* FROM EMP E
	WHERE SAL > (SELECT AVG(SAL)*2 FROM EMP
		     WHERE E.DEPTNO = DEPTNO);

A-20:	SELECT * FROM EMP E
	WHERE E.DEPTNO IN (SELECT DEPTNO FROM EMP
			   GROUP BY DEPTNO
			   HAVING MAX(SAL) > 10000)
        AND E.SAL < (SELECT MAX(SAL) FROM EMP
		     WHERE E.DEPTNO=DEPTNO);