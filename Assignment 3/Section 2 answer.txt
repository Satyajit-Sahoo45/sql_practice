SECTION 2: SUB-QUERIES
(INTERMEDIATE LEVEL)

1. SELECT *
   FROM EMP 
   WHERE SAL > 2000;

2. SELECT *
   FROM EMP 
   WHERE SAL > (SELECT AVG(SAL) FROM EMP);

3. SELECT *
   FROM EMP
   WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME='KING');

4. SELECT *
   FROM EMP
   WHERE JOB = (SELECT JOB FROM EMP WHERE ENAME='JONES');

5. SELECT *
   FROM EMP
   WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME='MILLER');

6. SELECT *
   FROM EMP
   WHERE DEPTNO=30
   AND SAL = (SELECT MAX(SAL) FROM EMP WHERE DEPTNO=30);

7. SELECT *
   FROM EMP
   WHERE SAL < ANY(SELECT SAL FROM EMP WHERE JOB='SALESMAN');

8. SELECT *
   FROM EMP
   WHERE SAL > (SELECT MAX(SAL) FROM EMP WHERE DEPTNO=20);

9. SELECT DEPTNO
   FROM EMP
   GROUP BY DEPTNO
   HAVING AVG(SAL) > 2000;

10. SELECT *
    FROM EMP
    WHERE SAL = (SELECT MIN(SAL) FROM EMP WHERE DEPTNO=10);

11. SELECT *
    FROM EMP
    WHERE HIREDATE > (SELECT MAX(HIREDATE) FROM EMP WHERE DEPTNO=20);

12. SELECT *
    FROM EMP
    WHERE DEPTNO IN (SELECT DEPTNO 
		     FROM DEPT D 
		     WHERE DEPTNO NOT IN (SELECT DEPTNO 
					FROM EMP E
					WHERE E.DEPTNO=D.DEPTNO AND
					JOB='SALESMAN' ));

13. SELECT *
    FROM EMP
    WHERE SAL > ALL (SELECT SAL FROM EMP WHERE JOB='CLERK');

14. SELECT *
    FROM EMP
    WHERE COMM = (SELECT E.COMM FROM EMP E WHERE E.ENAME='WARD');

15. SELECT *
    FROM EMP E
    WHERE E.SAL BETWEEN (SELECT MIN(SAL) FROM EMP WHERE DEPTNO=E.DEPTNO) 
			AND
		      	(SELECT MAX(SAL) FROM EMP WHERE DEPTNO=E.DEPTNO);

16. SELECT E.*
    FROM EMP E
    JOIN EMP M
    ON E.MGR=M.EMPNO
    WHERE E.HIREDATE < M.HIREDATE;

    SELECT *
    FROM EMP E
    WHERE E.HIREDATE < (SELECT HIREDATE
			FROM EMP M
			WHERE E.MGR=M.EMPNO);

17. SELECT *
    FROM EMP E
    JOIN DEPT D
    ON E.DEPTNO=D.DEPTNO
    WHERE D.LOC='BOSTON';

18. SELECT *
    FROM EMP E
    WHERE JOB IN (SELECT JOB FROM EMP WHERE DEPTNO=10);

19. SELECT *
    FROM (
	SELECT D.DEPTNO, D.DNAME, AVG(E.SAL) AS AVG_SAL
	FROM EMP E
        JOIN DEPT D
        ON E.DEPTNO=D.DEPTNO
        GROUP BY D.DEPTNO, D.DNAME
        ORDER BY AVG(E.SAL) DESC
    )  ROWNUM = 1;

20. SELECT *
    FROM EMP
    WHERE SAL > (SELECT AVG(SAL) FROM EMP);


ADVANCED LEVEL:
--------------

1. SELECT *
   FROM EMP 
   WHERE SAL > (SELECT MAX(SAL) FROM EMP WHERE DEPTNO=20);

2. SELECT *
   FROM EMP 
   WHERE SAL < (SELECT MIN(SAL) FROM EMP WHERE DEPTNO=30);

3. SELECT DISTINCT E.*
   FROM EMP E
   JOIN EMP EE
   ON E.SAL=EE.SAL
   WHERE E.DEPTNO <> EE.DEPTNO;

4. SELECT E.*
   FROM EMP E
   JOIN EMP M
   ON E.MGR = M.EMPNO
   WHERE E.SAL > M.SAL;

5. SELECT DISTINCT DEPTNO
   FROM EMP
   WHERE SAL = (SELECT MAX(SAL) FROM EMP);

6. SELECT *
   FROM EMP
   WHERE DEPTNO = (SELECT DEPTNO FROM (
					SELECT DEPTNO, AVG(SAL) AVG_SAL
					FROM EMP
					GROUP BY DEPTNO 
 					ORDER BY AVG_SAL ASC
 				      ) WHERE ROWNUM = 1);

7. SELECT *
   FROM emp 
   WHERE sal > (SELECT AVG(sal) FROM emp WHERE deptno = emp.deptno)
   AND sal < (SELECT AVG(sal) FROM emp);

8. SELECT *
   FROM EMP
   WHERE COMM > (SELECT AVG(COMM) FROM EMP WHERE COMM IS NOT NULL);

9. SELECT *
   FROM EMP
   WHERE HIREDATE < (SELECT MIN(HIREDATE) 
		     FROM EMP 
		     WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME='SALES'));

10. SELECT *
    FROM EMP
    WHERE JOB IN (SELECT JOB FROM EMP WHERE DEPTNO = (SELECT DEPTNO
						     FROM DEPT
						     WHERE DNAME='RESEARCH')) AND DEPTNO <> (SELECT DEPTNO 
											     FROM DEPT 
											     WHERE DNAME='RESEARCH');

11. SELECT *
    FROM EMP
    WHERE SAL = (SELECT MAX(SAL) FROM EMP
		 WHERE SAL < (SELECT MAX(SAL) FROM EMP));

12. SELECT *
    FROM EMP
    WHERE SAL > (SELECT SUM(SAL) FROM EMP WHERE DEPTNO = 10);

13. SELECT DEPTNO
    FROM (SELECT DEPTNO, MAX(SAL) AS MAX_SAL
	  FROM EMP
	  GROUP BY DEPTNO) T1
	  WHERE T1.MAX_SAL < (SELECT MIN(SAL) FROM EMP
			      WHERE DEPTNO=20);

14. SELECT *
    FROM EMP
    WHERE JOB IN (SELECT JOB FROM EMP WHERE DEPTNO=30) 
    AND JOB NOT IN (SELECT JOB FROM EMP WHERE DEPTNO<>30);

15. SELECT DEPTNO
    WHERE JOB <> 'SALESMAN';

16. SELECT *
    FROM EMP
    WHERE HIREDATE = (SELECT HIREDATE FROM EMP WHERE ENAME='JONES');

17. SELECT *
    FROM EMP E EXISTS (SELECT 1 FROM EMP X 
		       WHERE X.DEPTNO=E.DEPTNO AND X.SAL = E.SAL
                       AND X.EMPNO <> E.EMPNO);

18. SELECT *
    FROM EMP 
    WHERE COMM = (SELECT MAX(COMM) FROM EMP);

19. SELECT *
    FROM EMP
    WHERE SAL >= (SELECT MIN(SAL) 
		  FROM (SELECT SAL
			FROM EMP
			ORDER BY SAL DESC
		       ) TOP3
		  WHERE ROWNUM <= 3);

20. SELECT *
    FROM EMP
    WHERE DEPTNO IS NOT NULL AND DEPTNO NOT IN (SELECT DEPTNO FROM DEPT);
    