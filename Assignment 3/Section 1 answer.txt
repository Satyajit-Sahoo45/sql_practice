SECTION 1: JOIN/ LEFT JOIN/ RIGHT JOIN 
(INTERMEDIATE LEVEL)

1. SELECT E.ENAME, D.DNAME
   FROM EMP E
   JOIN DEPT D
   ON E.DEPTNO=D.DEPTNO;

2. SELECT E.ENAME, D.LOC
   FROM EMP E
   JOIN DEPT D
   ON E.DEPTNO=D.DEPTNO;

3. SELECT E.ENAME, E.DEPTNO, D.DNAME
   FROM EMP E
   JOIN DEPT D
   ON E.DEPTNO=D.DEPTNO
   WHERE D.LOC='DALLAS';

4. SELECT E.ENAME, E.JOB, D.DNAME
   FROM EMP E
   JOIN DEPT D
   ON E.DEPTNO = D.DEPTNO
   WHERE E.JOB='MANAGER';

5. SELECT D.*, E.*
   FROM DEPT D
   LEFT JOIN EMP E
   ON E.DEPTNO = D.DEPTNO;

6. SELECT D.DNAME, E.ENAME
   FROM DEPT D
   LEFT JOIN EMP E
   ON D.DEPTNO=E.DEPTNO
   WHERE E.EMPNO IS NULL;

7. SELECT E.ENAME, D.DNAME
   FROM EMP E
   LEFT JOIN DEPT D
   ON E.DEPTNO = D.DEPTNO
   WHERE D.DEPTNO IS NULL;

8. SELECT D.DNAME
   FROM EMP E
   RIGHT JOIN DEPT D
   ON E.DEPTNO = D.DEPTNO
   WHERE E.EMPNO IS NULL;

9. SELECT E.ENAME, D.DNAME
   FROM EMP E
   JOIN DEPT D
   ON E.DEPTNO=D.DEPTNO
   ORDER BY D.DNAME;

10. SELECT E.ENAME, M.ENAME AS EMP_MANAGER
    FROM EMP E
    JOIN EMP M
    ON E.MGR = M.EMPNO;

11. SELECT E.ENAME, M.ENAME AS MANAGER, D.LOC AS MANAGER_LOC
    FROM EMP E
    JOIN EMP M
    ON E.MGR = M.EMPNO
    JOIN DEPT D
    ON M.DEPTNO=D.DEPTNO;

12. SELECT E.*
    FROM EMP E
    WHERE E.DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME='SCOTT');

13. SELECT E.*
    FROM EMP E
    WHERE E.JOB IN (SELECT JOB FROM EMP WHERE DEPTNO=30);

14. SELECT E.ENAME, E.HIREDATE, M.ENAME AS MANAGER, M.HIREDATE
    FROM EMP E
    JOIN EMP M
    ON E.MGR=M.EMPNO
    WHERE E.HIREDATE < M.HIREDATE;

15. SELECT D.DNAME, COUNT(E.EMPNO)
    FROM DEPT D
    JOIN EMP E
    ON D.DEPTNO=E.DEPTNO
    GROUP BY D.DNAME;

16. SELECT E.ENAME, E.DEPTNO, D.DNAME
    FROM EMP E
    JOIN DEPT D
    ON E.DEPTNO=D.DEPTNO
    WHERE D.DEPTNO=20;

17. SELECT D.DNAME, MAX(E.SAL) AS MAX_SAL
    FROM DEPT D
    JOIN EMP E
    ON D.DEPTNO=E.DEPTNO
    GROUP BY D.DNAME;

18. SELECT E.ENAME, M.ENAME, D.DNAME
    FROM EMP E
    JOIN EMP M
    ON E.MGR=M.EMPNO
    JOIN DEPT D
    ON E.DEPTNO=D.DEPTNO
    JOIN DEPT DD
    ON M.DEPTNO=DD.DEPTNO
    WHERE D.DNAME != DD.DNAME;


    SELECT e.* FROM emp e JOIN emp m ON e.mgr = m.empno WHERE e.deptno <> m.deptno;

19. SELECT E.*S
    FROM EMP E
    WHERE E.JOB = (SELECT JOB FROM EMP WHERE ENAME='KING');

20. SELECT D.DNAME
    FROM DEPT D
    JOIN EMP E
    ON D.DEPTNO=E.DEPTNO
    WHERE E.JOB='MANAGER'
    GROUP BY D.DNAME
    HAVING COUNT(*) >= 2;


(ADVANCED LEVEL)
 --------------
1. SELECT E.ENAME AS EMP_NAME, D.DNAME AS EMP_DEPT_NAME, M.ENAME AS MANAGER, DD.DNAME AS MANAGER_DNAME
   FROM EMP E
   JOIN EMP M
   ON E.MGR=M.EMPNO
   LEFT JOIN DEPT D
   ON E.DEPTNO=D.DEPTNO
   LEFT JOIN DEPT DD
   ON M.DEPTNO=DD.DEPTNO;

2. SELECT E.ENAME, D.LOC AS EMP_LOC, M.ENAME AS MANGER_NAME, DD.LOC AS MANAGER_LOC
   FROM EMP E
   JOIN EMP M
   ON E.MGR=M.EMPNO
   JOIN DEPT D
   ON E.DEPTNO=D.DEPTNO
   JOIN DEPT DD
   ON M.DEPTNO=DD.DEPTNO
   WHERE D.LOC != DD.LOC;

3- SELECT E.ENAME, E.SAL
   FROM EMP E
   JOIN (SELECT DEPTNO, AVG(SAL) AS AVG_SAL 
 	 FROM EMP
	 GROUP BY DEPTNO
	) D
   ON E.DEPTNO=D.DEPTNO
   WHERE E.SAL > D.AVG_SAL;

4. SELECT E.ENAME, E.SAL, E.DEPTNO
   FROM EMP E
   JOIN EMP EE
   ON E.SAL=EE.SAL AND E.DEPTNO<>EE.DEPTNO;

5. SELECT D.*
   FROM DEPT D
   LEFT JOIN EMP E
   ON D.DEPTNO=E.DEPTNO
   WHERE E.EMPNO IS NULL;

6. SELECT E.*
   FROM EMP E
   WHERE E.DEPTNO NOT IN (SELECT DEPTNO FROM EMP WHERE JOB='CLERK');

7. SELECT E.*
   FROM EMP E
   WHERE E.SAL > (SELECT MAX(SAL) FROM EMP WHERE DEPTNO=30);

8. SELECT E.* FROM EMP E
   WHERE (SELECT COUNT(*) FROM EMP E2 WHERE E2.DEPTNO=E.DEPTNO) = 1;

9. SELECT e.*
   FROM emp e
   WHERE e.hiredate < (
   	SELECT MIN(x.hiredate)
   	FROM emp x
	   WHERE x.deptno = e.deptno
	     AND x.empno <> e.empno
	);

10. SELECT E.ENAME, M.ENAME AS MGR_OF_EMP, MM.ENAME AS MGR_OF_MGR
    FROM EMP E
    LEFT JOIN EMP M
    ON E.MGR=M.EMPNO
    LEFT JOIN EMP MM
    ON M.MGR=MM.EMPNO;

11. SELECT E.ENAME, D.DNAME
    FROM EMP E
    JOIN DEPT D
    ON E.DEPTNO=D.DEPTNO
    WHERE E.SAL > (SELECT AVG(SAL) FROM EMP);

12. SELECT D.DNAME, SUM(E.SAL)
    FROM DEPT D
    JOIN EMP E
    ON D.DEPTNO=E.DEPTNO
    GROUP BY D.DNAME 
    HAVING SUM(E.SAL) > 9000;

13. SELECT E.ENAME AS EMP_NAME, D.DNAME AS EMP_LOC, M.ENAME AS MGR_NAME, DD.DNAME AS MGR_LOC
    FROM EMP E
    JOIN EMP M
    ON E.MGR=M.EMPNO
    JOIN DEPT D
    ON E.DEPTNO = D.DEPTNO
    JOIN DEPT DD
    ON M.DEPTNO = DD.DEPTNO
    WHERE D.DNAME='NEW YORK'
    AND
    DD.DNAME='CHICAGO';

14. SELECT E.*
    FROM EMP E
    WHERE E.SAL > (SELECT MAX(SAL) FROM EMP WHERE DEPTNO=10) 
    AND
    E.DEPTNO<>10;

15. SELECT D.DEPTNO, D.DNAME, COUNT(DISTINCT E.JOB)
    FROM EMP E
    JOIN DEPT D
    ON E.DEPTNO=D.DEPTNO
    GROUP BY D.DNAME, D.DEPTNO
    HAVING COUNT(DISTINCT E.JOB) >= 3;

16. SELECT E.*
    FROM EMP E
    WHERE E.DEPTNO NOT IN (
			SELECT D.DEPTNO
			FROM DEPT D
			JOIN EMP EE
   			ON D.DEPTNO=EE.DEPTNO
 			AND EE.COMM IS NOT NULL AND EE.COMM<>0
		      );

17. SELECT e.* 
    FROM emp e 
    WHERE e.job IN (SELECT job 
	  	    FROM emp 
		    WHERE deptno = (SELECT deptno 
				    FROM dept 
				    WHERE dname='RESEARCH')) 
		    AND 
		    e.deptno <> (SELECT deptno 
				 FROM dept 
				 WHERE dname='RESEARCH');

EX: IN (CLERK, MANAGER, ANALYST) AND e.deptno != 20;


18.SELECT *
   FROM EMP E
   WHERE E.HIREDATE > (
		          SELECT MAX(E2.HIREDATE)
 			  FROM EMP E2
 			  WHERE E2.DEPTNO = E.DEPTNO
			  AND E2.EMPNO <> E.EMPNO
		       );

19. SELECT D.DEPTNO, D.DNAME, (MAX(SAL)-MIN(SAL)) AS DIFF
    FROM DEPT D
    JOIN EMP E
    ON D.DEPTNO=E.DEPTNO
    GROUP BY D.DEPTNO, D.DNAME
    ORDER BY DIFF DESC;

20. SELECT E.ENAME, E.HIREDATE, M.ENAME AS MANAGER, M.HIREDATE AS MGR_HIREDATE
    FROM EMP E
    JOIN EMP M
    ON E.MGR=M.EMPNO
    WHERE E.HIREDATE > M.HIREDATE;